{% extends "base.html" %}

{% block title %}Events Search Results{% endblock %}

{% block content %}
<!--
JSON data visulization
    <div id="results-as-json">
        <h2>Results as JSON</h2>
        <p>{{ data }}</p>
    </div>
  -->
<body>
<br>
  <div id="header-box">
    <div class="container-fluid col-11">
      <h3><strong>Search Results</strong></h3>
    </div>
  </div>

  <div class="container-fluid col-10">
    <p>
      There are 
      <span id="result-count">
        <strong>{{ data["page"]["totalElements"] }}</strong>
      </span>
      events matched your search.
    </p>
  </div>
  

<div class="container-fluid col-10">
  {% for event in results %}
  <li type="1" class="events-list">
    <div class="g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm position-relative">
      {{ event["dates"]["start"]["localDate"]}}
      <a href="/event/{{ event["id"] }}">
        {{ event["name"] }}
      </a>
      <p>
      {% if "classifications" in event %}
        {% if "genre" %}
          Genre: {{ event["classifications"][0]["genre"]["name"] }}
        {% endif %}

        {% if "segment" %}
          {{ event["classifications"][0]["segment"]["name"] }}
        {% endif %}
      </p>
        <p>Location: {{ event["_embedded"]["venues"][0]["city"]["name"] + ", " + event["_embedded"]["venues"][0]["state"]["name"] }}</p>
      {% endif %}
    </div>
  </li> 
  {% endfor %}

{% if "page" in data %}
{% if data.page.number > 0 %}
<button onclick="changePage('{{ +data.page.number - 1 }}')">Previous Page</button>
{% endif %}

{% if data.page.number + 1 < data.page.totalPages %}
<button onclick="changePage('{{ +data.page.number + 1 }}')">Next Page</button>
{% endif %}
{% endif %}


<br>
<a href="/">Return to Homepage</a>
</div>
</body>
<script src="/static/js/change_page.js"></script>
{% endblock %}